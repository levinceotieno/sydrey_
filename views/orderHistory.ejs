<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>My Orders - Sydreys Enterprise</title>
  <link rel="stylesheet" href="/styles/products.css">
  <link rel="stylesheet" href="/styles/new-menu.css">
  <link rel="stylesheet" href="/styles/orders.css">
</head>
<body>

  <div class="menu-backdrop" id="menu-backdrop"></div>

  <!-- Navbar Section -->
  <div class="navbar-container">
    <div class="navbar">

      <!-- ☰ Menu Icon -->
      <div class="menu-toggle" id="new-menu-toggle">☰</div>

      <!-- Brand Name -->
      <div class="logo">Sydrey Enterprise</div>

      <!-- Cart and Profile -->
      <div class="cart-profile">
	<!-- Cart Icon -->
	<a href="/cart">
	  <img src="/images/cart-icon.svg" alt="Shopping Cart" width="19" height="19" style="vertical-align: middle">
	  <%= cartCount %>
	</a>

	<!-- Profile Icon -->
	<% if (user) { %>
	  <a href="/user/profile">
	    <% if (user.profile_photo) { %>
	      <img src="<%= user.profile_photo %>?v=<%= Date.now() %>" alt="Profile Photo" class="profile-image">
	    <% } else { %>
	      <img src="/images/default.png" alt="Profile Photo" class="profile-image">
	    <% } %>
	  </a>
	<% } %>
      </div>
    </div>
  </div>

  <!-- Dropdown Menu -->
  <nav class="new-menu" id="new-menu">
    <ul>
	<li><a href="/">Home</a></li>
	</li><a href="/products" class="nav-link">Products</a></li>
	<li><a href="/bookings/services">Consultation</a></li>
	<li><a href="/orders/history">My Orders</a></li>
	<li><a href="/blogs">Blog</a></li>
	<li><a href="/user/profile">Profile</a></li>
	<% if (user && user.isAdmin) { %>
	  <li><a href="/bookings/admin" class="nav-link">Manage Bookings</a></li>
	  <li><a href="/admin" class="nav-link">Admin Dashboard</a></li>
	  <li><a href="/blogs/new" class="nav-link">Create Post</a></li>
	<% } %>
    </ul>
  </nav>

  <main class="main-container">
    <h1 class="page-title">My Orders</h1>
    <% if (orders.length > 0) { %>
      <div class="shop-now">
        <a href="/products" class="shop-now-button">Shop Now</a>
      </div>
      <div class="orders-container">
        <% orders.forEach(order => { %>
	  <div class="order-card">
	    <div><strong>Order ID:</strong> <%= order.id %></div>
	    <div><strong>Product Name:</strong> <%= order.product_name %></div>
	    <div><strong>Quantity:</strong> <%= order.quantity %></div>
	    <div><strong>Total Price:</strong> Ksh. <%= parseFloat(order.total_price).toFixed(2) %></div>
	    <div><strong>Delivery Address:</strong> <%= order.delivery_address %></div>
	    <div><strong>Status:</strong> <%= order.status %></div>
	    <div><strong>Delivery Date:</strong> <%= order.delivery_date %></div>
	    <div><strong>Created At:</strong> <%= new Date(order.created_at).toLocaleString() %></div>
	    <form action="/orders/delete/<%= order.id %>" method="POST" class="delete-order-form">
	       <button type="submit" class="delete-button">Delete Order</button>
	    </form>
	  </div>
        <% }); %>
      </div>
    <% } else { %>
      <p class="no-orders-message">No orders found. <a href="/products" class="shop-link">Start shopping now</a> to place your first order!</p>
    <% } %>
  </main>
   <script src="/js/menu.js" defer></script>
  <script>
    document.querySelector('.menu-toggle').addEventListener('click', () => {
      document.querySelector('.links').classList.toggle('visible');
    });
  </script>
</body>
</html>
