<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cart</title>
  <link rel="stylesheet" href="/styles/cart.css">
</head>
<body>
  <header>
    <h1>My Cart</h1>
    <a href="/products">Continue Shopping</a>
    <a href="/orders/history">Order History</a>
    <div class="cart-icon">
      <span class="cart-count"><%= cartCount %></span>
    </div>
  </header>

  <main>
    <% if (cart.length > 0) { %>
      <ul>
        <% cart.forEach(item => { %>
          <li>
            <strong><%= item.name %></strong> - 
            Quantity: 
            <input 
              type="number" 
              value="<%= item.quantity %>" 
              id="quantity-<%= item.product_id %>" 
              min="1"
            > 
            - Price: Ksh <%= item.price %>

            <button 
              onclick="updateCart('<%= item.product_id %>')"
              class="update-btn"
            >
              Update
            </button>
            <button 
              onclick="removeFromCart('<%= item.product_id %>')" 
              class="remove-btn"
            >
              Remove
            </button>
          </li>
        <% }) %>
      </ul>

      <button id="checkout-btn">Checkout</button>
    <% } else { %>
      <p>Your cart is empty.</p>
    <% } %>
  </main>

  <!-- Modal for Checkout Form -->
  <div id="checkout-modal" class="modal hidden">
    <div class="modal-content">
      <span class="close-btn" id="close-modal">&times;</span>
      <h2>Checkout</h2>
      <form id="checkout-form">
        <fieldset>
           <legend>Is this delivery within Kenya?</legend>
           <div class="radio-group">
              <label for="withinKenya">
                 <input type="radio" id="withinKenya" name="deliveryLocation" value="withinKenya" required>
                 Within Kenya
              </label>
              <label for="outsideKenya">
                 <input type="radio" id="outsideKenya" name="deliveryLocation" value="outsideKenya">
                 Outside Kenya
              </label>
           </div>
        </fieldset>

        <label for="deliveryAddress">Delivery Address:</label>
        <input type="text" id="deliveryAddress" name="deliveryAddress" placeholder="Enter delivery address" required>

        <button type="submit" class="submit-btn">Place Order</button>
      </form>
    </div>
  </div>

  <script>
     const userId = <%= JSON.stringify(userId) %>;
  </script>
  <script src="/js/orders.js"></script>
  <script src="/js/checkout.js"></script>
</body>
</html>
